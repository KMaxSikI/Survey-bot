# Telegram Bot для Анкетирования руководителей

Проект представляет собой Telegram-бота, который проводит анкетирование руководителей с целью идентификации, добавляет их в группу, удалять неактивных или уволенных пользователей.

## Оглавление
- [Описание проекта](#описание-проекта)
- [Примечание](#примечание)
- [Технологии](#технологии)
- [Установка](#установка)
- [Использование](#использование)
- [Структура проекта](#структура-проекта)
- [Описание скриптов](#описание-скриптов)

## Описание проекта

Бот управляет сотрудниками/руководителями, позволяя на основании небольшой анкеты добавлять пользователей в закрытый чат. Если пользователя уволили или понизили в должности, он удаляется из списка руководителей, а сам бот через какое-то время, в конкретном примере через 1 минуту, удаляет его из группы. Бот взаимодействует с базой данных и использует JSON-файл для хранения пользователей.

## Примечание

Перед запуском бота необходимо добавить в код свой токен от телеграм бота в следущие скрипты:

- **telegram_api.py** - строка 4
- **config.py** - строка 2

Добавить ссылку на группу, не забыть добавить самого бота в группу и дать ему полные права:

- **admin.py** - строка 9
- **questionnaire.py** - строка 119

Добавить id самой группы/чата:

- **admin.py** - строка 47
- **scheduler.py**  - строка 57



## Технологии

- Python 3.11
- Aiogram
- SQLAlchemy
- SQLite
- APScheduler

## Установка

1. Склонируйте репозиторий:
   ```bash
   git clone https://github.com/KMaxSikI/Survey-bot.git

2. Установите зависимости:
   ```bash
   pip install -r requirements.txt

## Использование

1. Запустите бота:

    ```bash
    python main.py
   
Далее по кнопке НАЧАТЬ или /Start в телеграм, бот начнет анкетирование, после заполнения анкеты, если человек прошедший анкетирование, занимает руководящую должность, то ему будет направлена ссылка для вступления в закрытую группу.

## Структура проекта

    ```bash

    project/
    │
    ├── bot/
    │   ├── handlers/
    │   │   ├── questionnaire.py  # Логика обработки анкетирования и FSM
    │   │   └── admin.py  # Логика для административных действий (приглашение и удаление пользователей)
    │   │
    │   ├── keyboards/
    │   │   └── inline.py 
    │   │
    │   ├── models/
    │   │   └── employee.py
    │   │
    │   ├── utils/
    │   │   ├── json_handler.py
    │   │   ├── scheduler.py
    │   │   ├── telegram_api.py
    │   │   └── validators.py
    │   │   
    │   ├── bot.py
    │   └── config.py
    │
    ├── db/
    │   ├── database.py
    │   └── models.py
    │
    ├── main.py
    ├── README.md
    └── requirements.txt

## Описание скриптов
### admin.py
Содержит хэндлеры для добавления и удаления пользователей из группы. Проверяет права пользователя перед выполнением операций.

### questionnaire.py
Обрабатывает анкету пользователя, валидирует данные и сохраняет их в базе данных. Уведомляет пользователя о результатах регистрации.

### inline.py
Создает инлайн-клавиатуру для взаимодействия с пользователем. В текущей версии не используется, но может быть добавлен в будущем.

### employee.py
Определяет модель данных для сотрудника, включая поля для Telegram ID, статуса руководителя и активности.

### json_handler.py
Содержит функции для загрузки и сохранения пользователей из/в JSON-файла.

### scheduler.py
Настраивает планировщик задач для периодической проверки неактивных сотрудников и их удаления из группы и базы данных.

### telegram_api.py
Содержит функции для взаимодействия с API Telegram, включая приглашение и удаление пользователей из группы.

### validators.py
Содержит функции для валидации данных пользователя.

### bot.py
Инициализирует бота и диспетчер, а также регистрирует хэндлеры.

### config.py
Содержит конфигурационные параметры, такие как токен бота и URL базы данных.

### database.py
Настраивает соединение с базой данных и определяет сессию.

### models.py
Определяет модели данных для использования в SQLAlchemy.

### main.py
Точка входа в проект, запускает бота и диспетчер.
